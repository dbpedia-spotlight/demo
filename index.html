<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DBpedia Spotlight</title>

<script src="selector.js" type="text/javascript"></script>
<script src="jquery-1.6.1.min.js" type="text/javascript"></script>
<script src="dbpedia-spotlight-0.3.js" type="text/javascript"></script>
<script src="jquery.getUrlParam.js" type="text/javascript"></script>

<script src="ui/jquery.ui.core.js"></script>
<script src="ui/jquery.ui.widget.js"></script>
<script src="ui/jquery.ui.mouse.js"></script>

<script src="ui/jquery.ui.slider.js"></script>
<script src="ui/jquery.ui.dialog.js"></script>
<script src="ui/jquery.ui.tabs.js"></script>
<script src="ui/jquery.ui.position.js" type="text/javascript" charset="utf-8"></script>
<script src="ui/jquery.ui.draggable.js" type="text/javascript" charset="utf-8"></script>


<script src="jquery.uniform/jquery.uniform.min.js"></script>

<script src="jquery.json-2.2.js"></script>

<script src="jstree/jquery.jstree.js" type="text/javascript" charset="utf-8"></script>
<script src="autoresize.jquery.min.js" type="text/javascript" charset="utf-8"></script>


<link rel="stylesheet" href="themes/base/jquery.ui.all.css">
<link rel="stylesheet" href="jquery.uniform/css/uniform.default.css" type="text/css" media="screen" charset="utf-8" />

<style>
body {
    font-size: small;
    font-family: "Myriad Pro", Verdana, Arial, sans-serif;

}
#text {
    border: 0;
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    font-family: inherit;
    overflow: auto;
    font-size: 14px;
    outline: none;
}
#text_container {
    font-size: 14px;
    background: #fff no-repeat bottom right;

}
#text_container.annotated {
    background: #f0f0f0 none;
    cursor:text;
    overflow: visible;
}
#text_container div {
    height: 100%;
    padding-left: 1px;

}
#text_container div a, a, a:visited {
    color: #135e6c;
}

#text_container {
    background: transparent;
}

#text_container .annotation {
    padding-left: 0;
    display: inline;
}
#text_container, #action_container, #filter_infobox {
    width: 700px;
    border-radius: 5px;
    border: 1px solid #ccc;
    border-color: #ddd #eee #eee #ddd;
    border-width: 1px 2px 2px 1px;
}
.container {
    margin: 0px 50px;
    padding: 8px;
    position: relative;
    clear: both;

}
#filter_infobox {
    background: #fafafa;
    text-align: center;
    margin-top: 10px;
}

#text {
    background: transparent;
}

#action_container {
    height: 170px;

    margin-bottom: 10px;

    background: #fafafa;
    height: auto;
    clear: left;
    float: left;

    position: relative;
}
#instructions {
    font-size: 80%;
    color: #666;
    text-align: left;
}


#action_options {
    float: left;
}
#action_buttons {
    height: auto;
    vertical-align: top;
    line-height: 100%;

    position: absolute;
    bottom: 8px;
    right: 8px;
}
.highlight { background-color: red; }

.main {
    width: 800px;
    margin-top: 2em;
    margin-left: auto;
    margin-right: auto;
}

.option {
    width: 308px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 12px;
}

#content {
    background-color: #ffa;
    -webkit-border-radius: 8px;
    -moz-border-radius: 8px;
    border-radius: 8px;
}
.bookmarklet p {
    text-align: center;
}
.bookmarklet a {
    display: inline;
    font-weight: bold;
    text-decoration: none;
    color: #333;

    cursor:move;
    background: #fff url(bookmark.png) 2px 3px no-repeat;
    border: 1px solid #bbb;
    font-size: 12px;

    text-align: left;

    min-height: 12px;
    vertical-align: middle;

    height: 14px;
    padding: 6px 6px 3px 20px;

    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
}
#logo {
    margin: 0 auto 20px auto;
    display: block
}
a.ui-slider-handle {
    outline: none;
    margin-top: 0.1em;
}
.ui-slider .ui-slider-handle {
    width: 0.9em;
    height: 0.9em;
}
.slider {
    margin: 0.2em 0.45em 0 0.45em;
    width: 250px;
    height: 8px;
}

#confidence, #support, #context {
    float: right;
    width: 30px;
    margin-top: 1em;
    margin-left: 1.5em;
}

div.annotation:hover ul.candidates {
    visibility: visible;

}
div.annotation {
    position: relative;
    overflow: visible;
}
#text_container .annotation {
    color: #135E6C;
}
#text_container .filtered {
    color: #666;
    text-decoration: none;
}
#text_container a.filtered:hover {
    text-decoration: underline;
}
#text_container div.filtered {
    color: #666;
    background: transparent;
    text-decoration: none;
}
#text_container div.filtered a.surfaceForm {
    color: #666;
    background-color: #F2F2F2;
    text-decoration: none;
}

ul.candidates {
    font-size: 100%;
    width: auto;
    margin: 0;
    padding: 0.2em 0 0 0;
    left: 0;
    top: 1.15em;
    display: block;

    position: absolute;
    visibility: hidden;
    z-index: 10;
    border: 1px solid #e6e6e6;
    border-right-width: 2px;
    border-radius: 3px;

}
ul.candidates li {
    list-style: none;
    margin: 0;
    padding: 0;
    border-width: 0 0 1px 0;
    border-style: solid;
    border-color: #e6e6e6;
    background: white;
    white-space: nowrap;
    padding: 0.15em 0.2em;
}
#text_container ul.candidates li a {
    display: inline-block;
}
#text_container div a.surfaceForm {
    display: inline-block;
    padding: 0 3px;
    border-radius: 3px;
    padding-right: 12px;
    border: 1px solid #f0f0f0;
    background: white 95% 50% no-repeat url(data:image/gif;base64,R0lGODlhBQADAIABAHulrf///yH5BAEAAAEALAAAAAAFAAMAAAIFhB0XC1sAOw==);
    cursor:default;
}
#text_container div div.annotation:hover a.surfaceForm {
    border-color: #c0c0c0;
    background-image: url(data:image/gif;base64,R0lGODlhBQADAIABAEJ+if///yH5BAEAAAEALAAAAAAFAAMAAAIFhB0XC1sAOw==);
}

ul.candidates li.candidate-0 {
    padding: 0.15em 0.85em 0.15em 0.2em;

}
#tree_id a {background: transparent; border: none;}
body .jstree-default.jstree-focused {
    background: transparent;
}

body .jstree li {
    line-height: auto;
    font-size: 12px;
}
#type_selector ul {
    margin: 0;
    padding: 0;
}
.tree {
    list-style: none;
    padding: 0;
    margin: 0;
}
#sparql_type {
    width: 100%;
    height: 150px;
}

#edit_text_wrapper {
    text-align: right;
    width: 100%;
    clear: both;
    padding-top: 2em;
}

#edit_text {
    display: none;
}

.copyright {
    color: #666;
    font-size: 80%;
    text-align: center;
}
#filterPolicy {
    text-align: center;
    padding: 0.5em 0;
}

#text_annotated {

    whitespace: pre-line;
}

#status_indicator {
    width: 20px;
    height: 20px;
    
    display: inline-block;
    background: none transparent;
}
#status_indicator.loading {
    background-image: url(data:image/gif;base64,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);
    background-position: 50% 50%;
    background-repeat: no-repeat;
}
.hidden {
    display: none;
}
#flag {
    width: 133px;
    height: 70px;
}
</style>

<script>
var annotated = false;
var textInput = null;

//Default value:
var server = 'http://spotlight.sztaki.hu:2222/rest'
var res_prefix = 'http://dbpedia.org/resource/'


function select_language(uri, text, lang) {
    $('#text').val(text);
    $('#webservice').text(uri);

    server = uri;

    if (lang == "en")
        res_prefix = "http://dbpedia.org/resource/"
    else
        res_prefix = "http://"+lang+".dbpedia.org/resource/"
}


var lastResponse;

function run(method) {

    $('#edit_text_wrapper').show();
    var settings = {
        'endpoint' : server,
        'confidence' : $('#confidence').val(),
        'support' : $('#support').val(),
        'powered_by': 'no',
        'showScores': 'yes',
        'spotter' : "Default",
        'disambiguator' : $('#disambiguator').val(),
        'policy' : getFilterPolicy(),
        'callback' : function callback(response) {lastResponse = response; $('#status_indicator').removeClass("loading");}
    }
    
    settings.sparql = getSPARQLQuery();
    settings.types = getTypes();

// will hide text object and show annotated text
    $('#text').hide();
    $('#text_annotated').remove();
    $('#text_container').prepend('<div id=text_annotated>'+$('#text').val().replace(/\n/g, "<br />\n")+'</div>');
    $('#text_annotated').annotate(settings);//TODO enable annotate(method, settings)
    $('#text_annotated').annotate(method);

    $('#status_indicator').addClass("loading");
    $('#text_container').addClass("annotated loading");

    $(".action_button").attr("disabled", true);
    $.uniform.update(".action_button");

//button to get the editable text box back for the user to modify as needed

    $('#edit_text').click(function() {
        annotated = false;

        $('#text_annotated').cancelAnnotation();

        $('#text').show();
        $('#text_annotated').remove();
        $('#text_container').removeClass("annotated loading");
        $('#status_indicator').removeClass("loading");

        //$("#text_container").unbind('click');
        $(".action_button").attr("disabled", false);
        $('#edit_text_wrapper').hide();
        $.uniform.update(".action_button");
    });

    annotated = true;

//get candidates for the surface form selected
    $("#text_annotated").bind("mouseup", getSuggestions);

}

function getTypes() {
    var checked_ids = [];
    $("#tree_dbpedia").jstree( "get_checked" ).each(function () {
        checked_ids.push("DBpedia:" + this.id);
    });
    $("#tree_freebase").jstree( "get_checked" ).each(function () {
        checked_ids.push("Freebase:" + this.id);
    });
    $("#tree_schema").jstree( "get_checked" ).each(function () {
        checked_ids.push("Schema:" + this.id);
    });
    return checked_ids.join(",");
}


function getSPARQLQuery() {
    return $('#sparql_type').val();
}

function getFilterPolicy() {
    if($('input[name=filterPolicy]:checked').val() == "blacklist")
        return "blacklist";
    else
        return "whitelist";
}



function getSuggestions(eventObject){
    var st = ''+Kolich.Selector.getSelected();
//console.log(st);
    if(st!=''){
        //console.log("You selected:\n"+st);
        $("#suggestdialog").hide().text($('#text').val());
        $('#suggestdialog').annotate("suggest");
        $('#suggestdialog').show(); //TODO instead of a div on the bottom, make it a popup
        /*$('<div></div>').dialog({
         width: 100,
         height: 200,
         autoOpen: true,
         position: [eventObject.pageX, eventObject.pageY],
         title : "Candidates..."
         });*/
    } else {
        $("#suggestdialog").hide();
    }

}

function runWithSettings() {
    if($("#nbest").is(':checked')){
        run('candidates');
    } else {
        run('best');
    }
}

// Override the onload event
$(document).ready(function() {

    $('#edit_text_wrapper').hide();

    //accept parameters from URL
    var t = $(document).getUrlParam('text');
    var execute = ($(document).getUrlParam('execute') == "yes");

    if ($.trim(t)!='' && t != "null") { $('#text').val(decodeURIComponent(t)); }

    $('textarea#text').autoResize({
        // On resize:
        onResize : function() {
            $(this).css({opacity:0.8});
        },
        // After resize:
        animateCallback : function() {
            $(this).css({opacity:1});
        },
        // Quite slow animation:
        animateDuration : 150,
        // More extra space:
        extraSpace : 15
    });


    $('#annotate').click(function() {
        runWithSettings();
    });

    $("#support-slider").slider({
        value:0,
        min: 0,
        max: 1000,
        step: 10,
        change: function( event, ui ) {
            $( "#support" ).val( ui.value );
            if(annotated)
                filterAnnotations();
        }
    });
    $( "#support" ).change(
        function() {
            $("#support-slider").slider("value", $( "#support" ).val());
        }
    );

    $("#confidence-slider").slider({
        value:0.0,
        min: 0,
        max: 1,
        step: 0.05,
        change: function( event, ui ) {
            $( "#confidence" ).val( ui.value );
            if(annotated)
                filterAnnotations();
        }
    });
    $( "#confidence" ).change(
        function() {
            $("#confidence-slider").slider("value", $( "#confidence" ).val());
        }
    );

    $("#context-slider").slider({
        value:0.0,
        min: 0,
        max: 1,
        step: 0.1,
        change: function( event, ui ) {
            $( "#context" ).val( ui.value );
            if(annotated)
                filterAnnotations();
        }
    });
    $( "#context" ).change(
        function() {
            $("#context-slider").slider("value", $( "#context" ).val());
        }
    );

    function filter(occ, minConfidence, minSupport, minContextualScore) {
        var squaredConfidence = minConfidence*minConfidence
        //console.log(occ);
        var support = parseInt(occ["support"]);
        var contextualScore = parseFloat(occ["contextualScore"]);
        var finalScore = parseFloat(occ["finalScore"]);
        var percentageOfSecondRank = parseFloat(occ["percentageOfSecondRank"]);

        //console.log( "support: " + support + " < " + minSupport +
        //            " || contextualScore: "+ contextualScore + " < " + minContextualScore +
        //             " || finalScore: "+ finalScore + " < " + simThreshold +
        //             " || percentageOfSecondRank: " + percentageOfSecondRank + "<" + (1-squaredConfidence));

        return ( (support < minSupport) ||
                 //(finalScore < simThreshold) ||
                 //(contextualScore < minContextualScore) ||
                 (percentageOfSecondRank > (1-squaredConfidence)) );
    }
    
    function filterAnnotations() {
        var minSupport = parseInt($( "#support" ).val());
        var minConfidence = parseFloat($( "#confidence" ).val());
        var minContextualScore = parseFloat($( "#context" ).val());

         $(".annotation").each(function() {
             var occ = { 'support': parseInt($(".support", $(this)).text()),
                         'finalScore': parseFloat($(".finalScore", $(this)).text()),
                         'contextualScore': parseFloat($(".contextualScore", $(this)).text()),
                         'percentageOfSecondRank': parseFloat($(".percentageOfSecondRank", $(this)).text()) }
              //console.log(occ);
              if (filter(occ, minConfidence, minSupport, minContextualScore)) {
                  $(this).addClass("filtered");
              } else {
                  $(this).removeClass("filtered");
              }
         });

    }
    
    $('#annotation_language').change(function() {

        switch($(this).val()) {
            case 'en': select_language("http://spotlight.sztaki.hu:2222/rest", "First documented in the 13th century, Berlin was the capital of the Kingdom of Prussia (1701–1918), the German Empire (1871–1918), the Weimar Republic (1919–33) and the Third Reich (1933–45). Berlin in the 1920s was the third largest municipality in the world. After World War II, the city became divided into East Berlin -- the capital of East Germany -- and West Berlin, a West German exclave surrounded by the Berlin Wall from 1961–89. Following German reunification in 1990, the city regained its status as the capital of Germany, hosting 147 foreign embassies.", "en"); break;
            case 'de': select_language("http://de.dbpedia.org/spotlight/rest", "Erstmals 1237 urkundlich erwähnt, war Berlin im Verlauf der Geschichte und in verschiedenen Staatsformen Hauptstadt Brandenburgs, Preußens und des Deutschen Reichs. Faktisch war der Ostteil der Stadt Hauptstadt der Deutschen Demokratischen Republik. Seit der Wiedervereinigung im Jahr 1990 ist Berlin gesamtdeutsche Hauptstadt mit Sitz des Bundespräsidenten seit 1994, des Deutschen Bundestags seit 1999 sowie des Bundesrats seit 2000.", "de"); break;
            case 'nl': select_language("http://nl.dbpedia.org/spotlight/rest", "In zijn geschiedenis, die teruggaat tot de dertiende eeuw, was Berlijn de hoofdstad van Pruisen (1701–1918), het Duitse Keizerrijk (1871–1918), de Weimarrepubliek (1919–1933) en nazi-Duitsland (1933–1945). Na de Tweede Wereldoorlog was Berlijn gedurende meer dan veertig jaar een verdeelde stad, waarbij het oostelijke deel als hoofdstad fungeerde van de Duitse Democratische Republiek en West-Berlijn een de facto exclave van West-Duitsland was. Na de Duitse hereniging in 1990 werd Berlijn de hoofdstad van de Bondsrepubliek Duitsland en de zetel van het parlement, de deelstaatvertegenwoordiging en het staatshoofd.", "nl"); break;
            case 'fr': select_language("http://spotlight.sztaki.hu:2225/rest", "La ville de Berlin se situe dans le nord-est de l'Allemagne, dans la plaine germano-polonaise, à 33 m d'altitude, au confluent de la Spree et de la Havel. Une particularité de la ville est la présence de nombreux lacs et rivières, le long des cours d'eau. On en trouve plusieurs à l'ouest, mais aussi à l'est avec le Müggelsee. Berlin est égayée par plusieurs rivières, canaux, parcs et lacs (Havel, Wannsee, Müggelsee, Spree, Dahme, Landwehrkanal). Elle possède en outre une architecture ancienne et classique très riche.", "fr"); break;
            case 'it': select_language("http://spotlight.sztaki.hu:2230/rest", "Berlino è situata nella parte orientale della Germania, a 70 km dal confine polacco. È situata nella regione geografica del Brandeburgo, ma non fa parte dell'omonimo Land, da cui è peraltro interamente circondata. La città ha una superficie molto vasta, di 892 km². L'estensione in senso nord-sud è di 38 km, in senso est-ovest di 45 km. Il centro di Berlino sorge sulle rive della Sprea (Spree in tedesco), in un'ampia valle di origine glaciale (Berliner Urstromtal) fra gli altipiani di Barnim e Teltow, orientata in senso est-ovest.", "it"); break;
            case 'ru': select_language("http://spotlight.sztaki.hu:2227/rest", "Берлин расположен на востоке Германии, в 70 километрах от границы с Польшей. Берлин обладает правами федеральной земли и целиком располагается внутри федеральной земли Бранденбург. Исторический центр Берлина находится в низине, в пойме реки Шпрее, между двумя моренными возвышенностями (холмами), называемыми Барним и Тельтов. Значительная часть современного города расположена также на этих холмах: часть территории в административных округах Райниккендорф, Панков, Лихтенберг, Марцан-Хеллерсдорф расположена на Барниме, а в округах Шарлоттенбург-Вильмерсдорф, Штеглиц-Целендорф, Темпельхоф-Шёнеберг и Нойкёльн — на возвышенности Тельтов.", "ru"); break;
            case 'es': select_language("http://spotlight.sztaki.hu:2231/rest", "Fundada en 1237 como Cölln, Berlín fue sucesivamente capital del Reino de Prusia (1701-1918), del Imperio Alemán (1871–1918), de la República de Weimar (1919–1933) y del Tercer Reich (1933–1945). Después de la Segunda Guerra Mundial, la ciudad fue dividida; la parte este de la ciudad se convirtió en la capital de la República Democrática Alemana, mientras que la región oeste de la ciudad se convirtió en un enclave de la República Federal de Alemania en el interior de la Alemania Oriental."); break;
            //case 'sv': select_language("http://spotlight.sztaki.hu:2222/rest", "First documented in the 13th century, Berlin was the capital of the Kingdom of Prussia (1701–1918), the German Empire (1871–1918), the Weimar Republic (1919–33) and the Third Reich (1933–45). Berlin in the 1920s was the third largest municipality in the world. After World War II, the city became divided into East Berlin -- the capital of East Germany -- and West Berlin, a West German exclave surrounded by the Berlin Wall from 1961–89. Following German reunification in 1990, the city regained its status as the capital of Germany, hosting 147 foreign embassies."); break;
            case 'pt': select_language("http://spotlight.sztaki.hu:2228/rest", "Pela primeira vez documentada no século XIII, Berlim foi sucessivamente a capital do Reino da Prússia (1701), do Império Alemão (1871-1918), da República de Weimar (1919-1932) e do Terceiro Reich (1933-1945). Depois da Segunda Guerra Mundial, a cidade foi dividida. Berlim Oriental se tornou a capital da República Democrática Alemã (RDA), enquanto Berlim Ocidental continuou sendo parte da República Federal da Alemanha (RFA).18 Com a reunificação alemã em 1990, a cidade passou a ser capital de toda a Alemanha.", "pt"); break;
            case 'hu': select_language("http://spotlight.sztaki.hu:2229/rest", "A város központja a Spree folyó partján fekszik, az ún. Varsó-Berlin-ősfolyamvölgyben. A folyó kelet-nyugati irányban folyik át a városon, a belvárosban két ágra oszlik és szigetet képez (Múzeum-sziget). Ezenkívül átszeli a várost a Landwehr-, a Lujza- és a berlin-spandaui hajózási csatorna, amelyeken 50-nél több híd ível át. E hidak közül a legszebb a Schlossbrücke (48 m hosszú), amelyet 1822–1824 között Schinkel tervei szerint építettek; széleit négy-négy, a katonai életet ábrázoló márvány szoborcsoport ékesíti. Jelentősebb hidak még: a Kurfürst híd, a nagy választófejedelem ércből öntött lovasszobrával; a Vilmos császár hídja, a 4 márvány szoborcsoporttal ékesített Belle-Alliance híd és a Herkules híd.", "hu"); break;
            //case 'da': select_language("http://spotlight.sztaki.hu:2222/rest", "First documented in the 13th century, Berlin was the capital of the Kingdom of Prussia (1701–1918), the German Empire (1871–1918), the Weimar Republic (1919–33) and the Third Reich (1933–45). Berlin in the 1920s was the third largest municipality in the world. After World War II, the city became divided into East Berlin -- the capital of East Germany -- and West Berlin, a West German exclave surrounded by the Berlin Wall from 1961–89. Following German reunification in 1990, the city regained its status as the capital of Germany, hosting 147 foreign embassies."); break;
        }

    });

    $("#method").change(
            function() {
                if(annotated){
                    runWithSettings();
                }
            }
    );

    $(".candidates").uniform()
    $("select, input").uniform();
    $("select, input").attr("disabled", false);
    $(".disabled").removeClass("disabled");
    $(".action_button").attr("disabled", false);

    $("#tree_dbpedia").jstree({
        "plugins" : [ "themes", "json_data", "checkbox" ],
        "themes" : {
            "icons" : false
        },
        "json_data" : {
            "ajax" : {
                "url" : "tree.dbpedia.json",
                "data" : function (n) {
                    return { id : n.attr ? n.attr("id") : 0 };
                }
            }
        }
    });

    $("#tree_freebase").jstree({
        "plugins" : [ "themes", "json_data", "checkbox" ],
        "themes" : {
            "icons" : false
        },
        "json_data" : {
            "ajax" : {
                "url" : "tree.freebase.json",
                "data" : function (n) {
                    return { id : n.attr ? n.attr("id") : 0 };
                }
            }
        }

    });

    $("#tree_schema").jstree({
        "plugins" : [ "themes", "json_data", "checkbox" ],
        "themes" : {
            "icons" : false
        },
        "json_data" : {
            "ajax" : {
                "url" : "tree.schema.json",
                "data" : function (n) {
                    return { id : n.attr ? n.attr("id") : 0 };
                }
            }
        }

    });


    $(".tree").jstree("set_theme","default");

    $("#type_selector").dialog({
        width: 750,
        height: 520,
        autoOpen: false,
        position: ['center', 50],
        title : "Select types…",
        modal: true,
        buttons: {
            Ok: function() {
                $( this ).dialog( "close" );

                var filteredBy;

                if(getSPARQLQuery() != "") {
                    filteredBy = "<strong>Filtered by SPARQL query</strong>";

                    if(filteredBy)
                        filteredBy += " (" + getFilterPolicy() + ").";

                }else if(getTypes() != "") {
                    var typeFilterSetting = "<strong>Only showing the types:</strong> ";
                    if(getFilterPolicy() == "blacklist")
                        typeFilterSetting = "<strong>Showing none of the types:</strong> ";
                    filteredBy = typeFilterSetting + getTypes().replace(/,/g, ", ");
                }


                if(filteredBy)
                    $("#filter_infobox").show().html(filteredBy);
                else
                    $("#filter_infobox").hide();
            },
            Cancel: function() {
                $( this ).dialog( "close" );
                $("#tree_dbpedia").uncheck_all();
                $("#tree_freebase").uncheck_all();
            }
        }
    });
    $(".ui-dialog-buttonset button").uniform();

    $("#types").click(function(event){
        $("#type_selector").dialog("open");
        $(".tabs").tabs();

    });

    $("#spotter").change(function(event){
        if(annotated){
            runWithSettings();
        }
    });

    $("#bookmarklet_container").hide();
    $("#bookmarklet_link").click(function(event) { $("#bookmarklet_container").show().dialog({
        dialogClass: 'alert',
        width: 700,
        height: 200,
        modal: true,
        position: ['center', 50],
        title : "Bookmarklet"
      });
    });



    if (execute) {
        runWithSettings();
    }
});

function sparqlExample(i) {

    switch(i) {
        case 1:
            s = "SELECT DISTINCT ?politician\nWHERE {\n    ?politician a <http://dbpedia.org/ontology/OfficeHolder> .\n    ?politician ?related <http://dbpedia.org/resource/Chicago>\n}";
            break;
        case 2:
            s = "PREFIX dbo: <http://dbpedia.org/ontology/>\n\nSELECT ?name ?birth ?death ?person WHERE {\n ?person dbo:birthPlace :Berlin .\n  ?person dbo:birthDate ?birth .\n    ?person foaf:name ?name .\n ?person dbo:deathDate ?death .\n    FILTER (?birth < \"1900-01-01\"^^xsd:date) .\n}\nORDER BY ?name";
            break;
        case 3:
            s = "SELECT ?film\nWHERE { ?film <http://purl.org/dc/terms/subject> <http://dbpedia.org/resource/Category:French_films> }";
            break;
        default:
            s = "";
    }
    $('#sparql_type').val(s);

}

</script>

</head>

<body>
<div class="main">
    <img id="logo" height="129" src="dbpedia_spotlight_logo.jpg" />


    <div id="action_container" class="container">

        <div id="action_options">

            <div class="option">
                <label for="confidence">Confidence:</label><input type="text" id="confidence" name="confidence" value="0.0"/>
                <div id="confidence-slider" class="slider"></div>
            </div>
            <div class="option">
                <label for="context">Annotation score:</label><input type="text" id="context" name="context" value="0.0"/>
                <div id="context-slider" class="slider"></div>
            </div><input type="checkbox" id="nbest" /><label for="nbest">n-best candidates</label>
        </div>

        <div id="action_buttons">
            <label for="annotation_language">Language:</label>
            <select id="annotation_language" class="action_button">
                <option value="en">English</option>
                <option value="de">German</option>
                <option value="fr">French</option>
                <option value="it">Italian</option>
                <option value="nl">Dutch</option>
                <option value="ru">Russian</option>
                <option value="es">Spanish</option>
                <!--<option value="sv">Swedish</option>-->
                <option value="pt">Portuguese</option>
                <option value="hu">Hungarian</option>
                <!--<option value="da">Danish</option>-->
            </select>
            <br/>
            <!--<select id="disambiguator" class="action_button">
                <option value="Default" selected>Default Disambiguation</option>
                <option value="Occurrences">Occurrence-centric</option>
                <option value="Document">Document-centric</option>
            </select>
            <br />-->

            
            <br/><br/><br/>
            <input class="action_button" id="types" type="button" enabled value="Select types…"/>

            <input class="action_button" id="annotate" type="button" enabled value="Annotate"/>
            <div id="status_indicator">&nbsp;</div>
        </div>
    </div>

    <div id="text_container" class="container">
        <textarea rows="10" id="text">First documented in the 13th century, Berlin was the capital of the Kingdom of Prussia (1701–1918), the German Empire (1871–1918), the Weimar Republic (1919–33) and the Third Reich (1933–45). Berlin in the 1920s was the third largest municipality in the world. After World War II, the city became divided into East Berlin -- the capital of East Germany -- and West Berlin, a West German exclave surrounded by the Berlin Wall from 1961–89. Following German reunification in 1990, the city regained its status as the capital of Germany, hosting 147 foreign embassies.</textarea>
        <div id="edit_text_wrapper">
            <input id="edit_text" type="button" value="Back to Text"/>
        </div>
    </div>
    <div id="filter_infobox" class="container" style="display: none;">
        
    </div>

    <!--TODO input id="view_source" type="button" value="View Source (RDFa annotations)"/-->
    <div id=suggestdialog></div>

    <div id="instructions" class="container">
        <p style="text-align: center;">This web service can be used via <span id="webservice">http://spotlight.sztaki.hu:2222/rest</span>.</p>
    
        <h2>You should know:</h2>
        <ul>
            <li>This interface has been tested with Firefox 6.0.2 and Chromium 12.0.</li>
            <li>We have a cute <a id="bookmarklet_link" href="#bookmarklet_container">bookmarklet</a> that you should try out!</li>
        </ul>
    </div>

    <div id="bookmarklet_container" class="container">
        <div>
            <br/>
            Tired of copying and pasting text here?<br/>
            Drag the box "Annotate with DBpedia Spotlight" below to your bookmarks bar (Or right-click and "Bookmark this link").
            After doing that, simply select text in any page and click on the bookmark you've just saved to your bookmarks bar.
            That will send the text you've selected to DBpedia Spotlight and take you to the annotated text in a blink!
            <div class="bookmarklet">
                <p>
                    <a href="javascript:function se(d) {return d.selection ? d.selection.createRange().text : d.getSelection()} s = se(document); for (i=0; i<frames.length && !s; i++) s = se(frames[i].document); if (!s || s=='') s = prompt('Enter%20text%20to%20annotate%20with%20DBpedia%20Spotlight',''); open('http://dbpedia-spotlight.github.com/demo/index.html' + (s ? '?execute=yes&client=bookmarklet&text=' + encodeURIComponent(s) : '')).focus();">
                        Annotate with DBpedia Spotlight
                    </a>
                </p>
            </div>


        </div>
    </div>

    <div id="type_selector">
        <div id="filterPolicy">
            <input id="filterPolicyWL" type="radio" name="filterPolicy" value="whitelist" checked>Only these types</input>
            <input id="filterPolicyBL" type="radio" name="filterPolicy" value="blacklist">None of these types</input>
        </div>

        <div class="tabs">
            <ul>
                <li><a href="#tabs-1">DBpedia</a></li>
                <li><a href="#tabs-2">Freebase</a></li>
                <li><a href="#tabs-3">Schema.org</a></li>
                <li><a href="#tabs-4">Custom (SPARQL)</a></li>
            </ul>

            <div id="tabs-1">
                <ul>
                    <li id="tree_dbpedia" class="tree" />
                </ul>
            </div>

            <div id="tabs-2">
                <ul>
                    <li id="tree_freebase" class="tree" />
                </ul>
            </div>

            <div id="tabs-3">
                <ul>
                    <li id="tree_schema" class="tree" />
                </ul>
            </div>

            <div id="tabs-4">

                <textarea id="sparql_type" rows="8"></textarea>
                
                <div id="sparqlExamples">
                    <strong>Example queries:</strong>
                    <a href="#" onclick="javascript: sparqlExample(1);">Politicians from Chicago</a>,
                    <a href="#" onclick="javascript: sparqlExample(2);">People born in Berlin before 1900</a>,
                    <a href="#" onclick="javascript: sparqlExample(3);">French films</a>.
                </div>

            </div>

        </div>

    </div>
</div>

<div class=copyright>This demonstration uses the <a href=http://plugins.jquery.com/project/dbpedia-spotlight>DBpedia Spotlight jQuery Plugin v0.3</a>. <br/> For the latest versions, please visit: <a href=http://spotlight.dbpedia.org>http://spotlight.dbpedia.org</a></div>
<br/>

</body>
</html>

